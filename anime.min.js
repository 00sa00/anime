/*
 2017 Julian Garnier
 Released under the MIT license
*/
(function(y,v){"function"===typeof define&&define.amd?define([],v):"object"===typeof module&&module.exports?module.exports=v():y.anime=v()})(this,function(){function y(a){return(a=/\(([^)]+)\)/.exec(a))?a[1].split(",").map(function(a){return parseFloat(a)}):[]}function v(a,b){function d(a){var c=b?b*a/1E3:a;c=1>h?Math.exp(-c*h*q)*(1*Math.cos(r*c)+n*Math.sin(r*c)):(1+n*c)*Math.exp(-c*q);return 0===a||1===a?a:1-c}function c(){var b=A.springs[a];if(b)return b;b=1/6;for(var c=0,e=0;;)if(c+=b,1===d(c)){if(e++,
16<=e)break}else e=0;b=c*b*1E3;return A.springs[a]=b}var e=y(a),k=w(f.und(e[0])?1:e[0],.1,100),l=w(f.und(e[1])?100:e[1],.1,100),m=w(f.und(e[2])?10:e[2],.1,100);e=w(f.und(e[3])?0:e[3],.1,100);var q=Math.sqrt(l/k),h=m/(2*Math.sqrt(l*k)),r=1>h?q*Math.sqrt(1-h*h):0,n=1>h?(h*q+-e)/r:-e+q;return b?d:c}function B(a,b){b=void 0===b?.5:b;var d=w(void 0===a?1:a,1,10),c=w(b,.1,2);return function(a){return 0===a||1===a?a:-d*Math.pow(2,10*(a-1))*Math.sin(2*(a-1-c/(2*Math.PI)*Math.asin(1/d))*Math.PI/c)}}function ca(a){a=
void 0===a?10:a;return function(b){return 1/a*Math.round(b*a)}}function da(a){var b=a.easing,d=b.split("(")[0],c=y(b),e=I[d];switch(d){case "spring":return v(b,a.duration);case "cubicBezier":return J.apply(null,c);case "steps":return ca.apply(null,c);default:return f.fnc(e)?e.apply(null,c):J.apply(null,e)}}function K(a){try{return document.querySelectorAll(a)}catch(b){}}function D(a,b){for(var d=a.length,c=2<=arguments.length?arguments[1]:void 0,e=[],k=0;k<d;k++)if(k in a){var l=a[k];b.call(c,l,k,
a)&&e.push(l)}return e}function E(a){return a.reduce(function(a,d){return a.concat(f.arr(d)?E(d):d)},[])}function L(a){if(f.arr(a))return a;f.str(a)&&(a=K(a)||a);return a instanceof NodeList||a instanceof HTMLCollection?[].slice.call(a):[a]}function M(a,b){return a.some(function(a){return a===b})}function F(a){var b={},d;for(d in a)b[d]=a[d];return b}function G(a,b){var d=F(a),c;for(c in a)d[c]=b.hasOwnProperty(c)?b[c]:a[c];return d}function z(a,b){var d=F(a),c;for(c in b)d[c]=f.und(a[c])?b[c]:a[c];
return d}function ea(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,d,l){return b+b+d+d+l+l});var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);a=parseInt(b[1],16);var d=parseInt(b[2],16);b=parseInt(b[3],16);return"rgba("+a+","+d+","+b+",1)"}function fa(a){function b(a,b,c){0>c&&(c+=1);1<c&&--c;return c<1/6?a+6*(b-a)*c:.5>c?b:c<2/3?a+(b-a)*(2/3-c)*6:a}var d=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g.exec(a)||/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g.exec(a);a=parseInt(d[1],
10)/360;var c=parseInt(d[2],10)/100,e=parseInt(d[3],10)/100;d=d[4]||1;if(0==c)e=c=a=e;else{var k=.5>e?e*(1+c):e+c-e*c,l=2*e-k;e=b(l,k,a+1/3);c=b(l,k,a);a=b(l,k,a-1/3)}return"rgba("+255*e+","+255*c+","+255*a+","+d+")"}function x(a){if(a=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/.exec(a))return a[2]}function w(a,b,d){return Math.min(Math.max(a,b),d)}function N(a,b){return f.fnc(a)?a(b.target,b.id,b.total):a}function O(a,b,d){var c=A.CSS[b+d];if(c)return c;
c=document.createElement(a.tagName);a=a.parentNode||document.body;a.appendChild(c);c.style.position="absolute";c.style.width=100+d;var e=100/c.offsetWidth;a.removeChild(c);c=e*parseFloat(b);return A.CSS[b+d]=c}function P(a,b,d){if(b in a.style){var c=b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();b=a.style[b]||getComputedStyle(a).getPropertyValue(c)||"0";return d?O(a,b,d):b}}function Q(a,b){if(f.dom(a)&&(a.getAttribute(b)||f.svg(a)&&a[b]))return"attribute";if(f.dom(a)&&M(ha,b))return"transform";
if(f.dom(a)&&"transform"!==b&&P(a,b))return"css";if(null!=a[b])return"object"}function R(a){if(f.dom(a)){a=a.style.transform||"";for(var b=/(\w+)\(([^)]*)\)/g,d=new Map,c;c=b.exec(a);)d.set(c[1],c[2]);return d}}function S(a,b,d,c){switch(Q(a,b)){case "transform":if(-1<b.indexOf("scale"))var e=1;else e=-1<b.indexOf("translate")||"perspective"===b?"px":-1<b.indexOf("rotate")||-1<b.indexOf("skew")?"deg":void 0,e=0+e;e=R(a).get(b)||e;a=d?O(a,e,d):e;c.transforms.list.set(b,a);c.transforms.last=b;return a;
case "css":return P(a,b,d);case "attribute":return a.getAttribute(b);default:return a[b]||0}}function T(a,b){var d=/^(\*=|\+=|-=)/.exec(a);if(!d)return a;var c=x(a)||0;b=parseFloat(b);a=parseFloat(a.replace(d[0],""));switch(d[0][0]){case "+":return b+a+c;case "-":return b-a+c;case "*":return b*a+c}}function H(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))}function U(a){a=a.points;for(var b=0,d,c=0;c<a.numberOfItems;c++){var e=a.getItem(c);0<c&&(b+=H(d,e));d=e}return b}function V(a){if(a.getTotalLength)return a.getTotalLength();
switch(a.tagName.toLowerCase()){case "circle":return 2*Math.PI*a.getAttribute("r");case "rect":return 2*a.getAttribute("width")+2*a.getAttribute("height");case "line":return H({x:a.getAttribute("x1"),y:a.getAttribute("y1")},{x:a.getAttribute("x2"),y:a.getAttribute("y2")});case "polyline":return U(a);case "polygon":var b=a.points;return U(a)+H(b.getItem(b.numberOfItems-1),b.getItem(0))}}function ia(a,b){function d(c){c=void 0===c?0:c;return a.el.getPointAtLength(1<=b+c?b+c:0)}var c=d(),e=d(-1),k=d(1);
switch(a.property){case "x":return c.x;case "y":return c.y;case "angle":return 180*Math.atan2(k.y-e.y,k.x-e.x)/Math.PI}}function W(a,b){var d=/-?\d*\.?\d+/g;var c=f.pth(a)?a.totalLength:a;if(f.col(c))if(f.rgb(c)){var e=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g.exec(c);c=e?"rgba("+e[1]+",1)":c}else c=f.hex(c)?ea(c):f.hsl(c)?fa(c):void 0;else e=(e=x(c))?c.substr(0,c.length-e.length):c,c=b&&!/\s/g.test(c)?e+b:e;c+="";return{original:c,numbers:c.match(d)?c.match(d).map(Number):[0],strings:f.str(a)||b?c.split(d):
[]}}function X(a){a=a?E(f.arr(a)?a.map(L):L(a)):[];return D(a,function(a,d,c){return c.indexOf(a)===d})}function ja(a){var b=X(a);return b.map(function(a,c){return{target:a,id:c,total:b.length,transforms:{list:R(a)}}})}function ka(a,b){var d=F(b);/^spring/.test(d.easing)&&(d.duration=v(d.easing));if(f.arr(a)){var c=a.length;2!==c||f.obj(a[0])?f.fnc(b.duration)||(d.duration=b.duration/c):a={value:a}}return(f.arr(a)?a:[a]).map(function(a,c){a=f.obj(a)&&!f.pth(a)?a:{value:a};f.und(a.delay)&&(a.delay=
c?0:b.delay);return a}).map(function(a){return z(a,d)})}function la(a,b){var d={},c;for(c in a){var e=N(a[c],b);f.arr(e)&&(e=e.map(function(a){return N(a,b)}),1===e.length&&(e=e[0]));d[c]=e}d.duration=parseFloat(d.duration);d.delay=parseFloat(d.delay);return d}function ma(a,b){var d;return a.tweens.map(function(c){c=la(c,b);var e=c.value,k=f.arr(e)?e[1]:e,l=x(k),m=S(b.target,a.name,l,b),q=d?d.to.original:m;q=f.arr(e)?e[0]:q;m=x(q)||x(m);l=l||m;c.from=W(q,l);c.to=W(T(k,q),l);c.start=d?d.end:0;c.end=
c.start+c.delay+c.duration+c.endDelay;c.easing=da(c);c.isPath=f.pth(e);c.isColor=f.col(c.from.original);c.isColor&&(c.round=1);return d=c})}function na(a,b){return D(E(a.map(function(a){return b.map(function(b){var c=Q(a.target,b.name);if(c){var d=ma(b,a);b={type:c,property:b.name,animatable:a,tweens:d,duration:d[d.length-1].end,delay:d[0].delay}}else b=void 0;return b})})),function(a){return!f.und(a)})}function Y(a,b,d){var c="delay"===a;return b.length?(c?Math.min:Math.max).apply(Math,b.map(function(b){return b[a]})):
c?d.delay:d.delay+d.duration}function oa(a){var b=G(pa,a),d=G(Z,a),c=ja(a.targets),e=[],k;for(k in a)b.hasOwnProperty(k)||d.hasOwnProperty(k)||"targets"===k||e.push({name:k,tweens:ka(a[k],d)});e=na(c,e);return z(b,{states:{default:a},children:[],animatables:c,animations:e,duration:Y("duration",e,d),delay:Y("delay",e,d)})}function p(a){function b(){return window.Promise&&new Promise(function(a){return x=a})}function d(){g.reversed=!g.reversed;n.forEach(function(a){return a.reversed=g.reversed})}function c(a){return g.reversed?
g.duration-a:a}function e(a){for(var b=0,c=g.animations,d=c.length;b<d;){var e=c[b],k=e.animatable,f=e.tweens,l=f.length-1,h=f[l];l&&(h=D(f,function(b){return a<b.end})[0]||h);f=w(a-h.start-h.delay,0,h.duration)/h.duration;var m=isNaN(f)?1:h.easing(f);f=h.to.strings;var q=h.round;l=[];var t=h.to.numbers.length,n=void 0;for(n=0;n<t;n++){var r=void 0;r=h.to.numbers[n];var p=h.from.numbers[n];r=h.isPath?ia(h.value,m*r):p+m*(r-p);q&&(h.isColor&&2<n||(r=Math.round(r*q)/q));l.push(r)}if(h=f.length)for(n=
f[0],m=0;m<h;m++)q=f[m+1],t=l[m],isNaN(t)||(n=q?n+(t+q):n+(t+" "));else n=l[0];qa[e.type](k.target,e.property,n,k.transforms);e.currentValue=n;b++}g.currentTime=a}function k(a){if(g[a])g[a](g)}function f(){g.remaining&&!0!==g.remaining&&g.remaining--}function m(a){var l=g.duration,m=g.delay,t=c(a);g.progress=w(t/l*100,0,100);if(n)if(t>=g.currentTime)for(var p=0;p<v;p++)n[p].seek(t-n[p].timelineOffset);else for(p=v;p--;)n[p].seek(t-n[p].timelineOffset);if(t>=m||!l)g.began||(g.began=!0,k("begin")),
k("run");if(t>m&&t<l)e(t);else if(t<=m&&0!==g.currentTime&&(e(0),g.reversed&&f()),t>=l&&g.currentTime!==l||!l)e(l),g.reversed||f();k("update");a>=l&&(h=0,g.remaining?(q=r,"alternate"===g.direction&&d()):(g.paused=!0,g.completed||(g.completed=!0,k("complete"),"Promise"in window&&(x(),y=b()))))}a=void 0===a?{}:a;var q=0,h=0,r=0,n,v=0,x=null,y=b(),g=oa(a);g.reset=function(){var a=g.direction,b=g.loop;g.currentTime=0;g.progress=0;g.paused=!0;g.began=!1;g.completed=!1;g.reversed="reverse"===a;g.remaining=
"alternate"===a&&1===b?2:b;n=g.children;for(a=v=n.length;a--;)g.children[a].reset();e(0)};g.tick=function(a){r=a;q||(q=r);m((r+(h-q))*p.speed)};g.seek=function(a){m(c(a))};g.pause=function(){g.paused=!0};g.play=function(){g.paused&&(g.paused=!1,q=0,h=c(g.currentTime),u.push(g),C||ra())};g.reverse=function(){d();q=0;h=c(g.currentTime)};g.restart=function(){g.pause();g.reset();g.play()};g.animateTo=function(a,b,c){b=void 0===b?{}:b;a=z(b,z(g.states[a],g.states.default));a=p(a);c?a.seek(a.duration):
a.play()};g.goTo=function(a,b){g.animateTo(a,b,!0)};g.finished=y;g.reset();g.startTime&&m(g.startTime-g.duration*Math.floor(g.startTime/g.duration));g.autoplay&&g.play();return g}function aa(a,b){for(var d=b.length;d--;)M(a,b[d].animatable.target)&&b.splice(d,1)}var pa={update:void 0,begin:void 0,run:void 0,complete:void 0,loop:1,direction:"normal",autoplay:!0,startTime:0,timelineOffset:0},Z={duration:1E3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},ha="translateX translateY translateZ rotate rotateX rotateY rotateZ scale scaleX scaleY scaleZ skew skewX skewY perspective".split(" "),
A={CSS:{},springs:{}},f={arr:function(a){return Array.isArray(a)},obj:function(a){return-1<Object.prototype.toString.call(a).indexOf("Object")},pth:function(a){return f.obj(a)&&a.hasOwnProperty("totalLength")},svg:function(a){return a instanceof SVGElement},dom:function(a){return a.nodeType||f.svg(a)},str:function(a){return"string"===typeof a},fnc:function(a){return"function"===typeof a},und:function(a){return"undefined"===typeof a},hex:function(a){return/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(a)},
rgb:function(a){return/^rgb/.test(a)},hsl:function(a){return/^hsl/.test(a)},col:function(a){return f.hex(a)||f.rgb(a)||f.hsl(a)}},J=function(){function a(a,d,c){return(((1-3*c+3*d)*a+(3*c-6*d))*a+3*d)*a}return function(b,d,c,e){if(0<=b&&1>=b&&0<=c&&1>=c){var k=new Float32Array(11);if(b!==d||c!==e)for(var f=0;11>f;++f)k[f]=a(.1*f,b,c);return function(f){if(b===d&&c===e||0===f||1===f)return f;for(var l=0,h=1;10!==h&&k[h]<=f;++h)l+=.1;--h;h=l+(f-k[h])/(k[h+1]-k[h])*.1;var m=3*(1-3*c+3*b)*h*h+2*(3*c-
6*b)*h+3*b;if(.001<=m){for(l=0;4>l;++l){m=3*(1-3*c+3*b)*h*h+2*(3*c-6*b)*h+3*b;if(0===m)break;var n=a(h,b,c)-f;h-=n/m}f=h}else if(0===m)f=h;else{h=l;l+=.1;var p=0;do n=h+(l-h)/2,m=a(n,b,c)-f,0<m?l=n:h=n;while(1e-7<Math.abs(m)&&10>++p);f=n}return a(f,d,e)}}}}(),I=function(){var a="Quad Cubic Quart Quint Sine Expo Circ Back Elastic".split(" "),b={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],
B],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(a,b){return function(c){return 1-B(a,b)(1-c)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(a,b){return function(c){return.5>c?B(a,b)(2*c)/2:1-B(a,b)(-2*c+2)/2}}]},d={linear:[.25,.25,.75,.75]},c={},e;for(e in b)c.equation=e,b[c.equation].forEach(function(b){return function(c,
e){d["ease"+b.equation+a[e]]=c}}(c)),c={equation:c.equation};return d}(),qa={css:function(a,b,d){return a.style[b]=d},attribute:function(a,b,d){return a.setAttribute(b,d)},object:function(a,b,d){return a[b]=d},transform:function(a,b,d,c,e){c.list.set(b,d);if(b===c.last||e){var f="";c.list.forEach(function(a,b){f+=b+"("+a+") "});a.style.transform=f}}},u=[],ba=[],C,ra=function(){function a(){C=requestAnimationFrame(b)}function b(b){var c=u.length;if(c){for(var d=0;d<c;){var f=u[d];f.paused?(f=u.indexOf(f),
-1<f&&(u.splice(f,1),c=u.length)):f.tick(b);d++}a()}else C=cancelAnimationFrame(C)}return a}();document.addEventListener("visibilitychange",function(){document.hidden?(u.forEach(function(a){return a.pause()}),ba=u.slice(0),u=[]):ba.forEach(function(a){return a.play()})});p.version="3.0.0";p.speed=1;p.running=u;p.remove=function(a){a=X(a);for(var b=u.length;b--;){var d=u[b],c=d.animations,e=d.children;aa(a,c);for(var f=e.length;f--;){var l=e[f],m=l.animations;aa(a,m);m.length||l.children.length||e.splice(f,
1)}c.length||e.length||d.pause()}};p.getValue=S;p.path=function(a,b){var d=f.str(a)?K(a)[0]:a,c=b||100;return function(a){return{el:d,property:a,totalLength:V(d)*(c/100)}}};p.setDashoffset=function(a){var b=V(a);a.setAttribute("stroke-dasharray",b);return b};p.timeline=function(a){a=void 0===a?{}:a;var b=p(a);b.pause();b.duration=0;b.add=function(d,c){function e(a){a.began=!0;a.completed=!0}b.children.forEach(e);var k=z(d,G(Z,a));k.targets=k.targets||a.targets;d=b.duration;k.autoplay=!1;k.direction=
b.direction;k.timelineOffset=f.und(c)?d:T(c,d);e(b);b.seek(k.timelineOffset);c=p(k);e(c);k=c.duration+k.timelineOffset;f.fnc(b.delay)&&(b.delay=c.delay);if(f.fnc(d)||k>d)b.duration=k;b.children.push(c);b.seek(0);b.reset();b.autoplay&&b.restart();return b};return b};p.easings=I;p.random=function(a,b){return Math.floor(Math.random()*(b-a+1))+a};return p});